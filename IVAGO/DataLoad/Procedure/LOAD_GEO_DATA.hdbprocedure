PROCEDURE "PINAKIP"."Pinaki.IVAGO.DataLoad.Procedure::LOAD_GEO_DATA" ( 
	IN INPUT_DATA "PINAKIP"."IN_IVAGO_GEO_DATA",
	OUT OUTPUT_TABLE  PINAKIP.OUT_IVAGO_GEO_DATA  
) 
	LANGUAGE SQLSCRIPT 
	SQL SECURITY INVOKER 
	DEFAULT SCHEMA PINAKIP
	AS
BEGIN
	OUTPUT_TABLE =  
					select 
						MANDT,
						CASENR,
						new ST_GEOMETRY('POINT(' || XML_LATITUDE || ' ' ||XML_LONGITUDE ||')', 4326).ST_Transform(3857) as GEO_ID
					from :INPUT_DATA ;
END;


